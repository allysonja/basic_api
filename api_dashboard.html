<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>Basic API</title>
  <meta name="description" content="Basic API Dashboard">
  <meta name="author" content="Sonja">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>


</head>

<body>

<h4>Show all users</h4>

<table id="listOfUsers">
	<tr>
		<th>Username</th>
		<th>Email</th>
	</tr>
</table>

<h4>Create new user</h4>
<p>Username</p>
<input id="username" type="text" placeholder="username">
<p>Email</p>
<input id="email" type="text" placeholder="email">
<br>
<br>
<button id="POST">POST</button>

<p id="successfulSubmit" style="display: hidden;"></p>

<script>
$(document).ready(function(){

	$.ajax({
		url: 'http://127.0.0.1:5000/user',
		type: "GET",
		success: function (response) {
			function display(response) {
			   return '<tr><td>'+response.username+'</td><td>'+response.email+'</td></tr>'
			}
			function show_info(details) {
			   $("#listOfUsers").append(details)
			} 
			response.map(display).forEach(show_info);
		}
	});

	$("#POST").click(function(){

		// VARIABLES
		var username = $('#username').val().toLowerCase();
		var email = $('#email').val().toLowerCase();

		$.ajax({
			url: 'http://127.0.0.1:5000/user',
			type: "POST",
			contentType: "application/json; charset=utf-8",
			dataType: "json",
			data: JSON.stringify({username: username, email: email}),
			success: function (response) {
				// console.log(response);
				$("#successfulSubmit").html("Successful Submit");
				successfulSubmit.style.display = 'block';
			}
		});
	});
});

</script>
</body>
</html>